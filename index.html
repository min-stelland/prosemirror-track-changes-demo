<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>track changes demo with prosemirror and fiduswriter ModTrack</title>
</head>

<body>
    <div id="app">
        <!-- http://www.cheeseipsum.co.uk/ -->
        <div id="edit-me">
            <h1 id="wow">cheese level 1</h1>
            <p>Cheese slices parmesan bavarian bergkase. Cheddar edam airedale bocconcini everyone loves queso fromage
                port-salut. Paneer pepper jack fondue fromage frais cheese strings swiss jarlsberg babybel. Cheese and
                wine airedale emmental cheese on toast queso fromage cheesy feet croque monsieur. When the cheese comes
                out everybody's happy cheese and wine dolcelatte.</p>
            <h2>cheese level 2</h2>
            <p>Fromage melted cheese cheeseburger. Boursin fromage airedale macaroni cheese macaroni cheese pecorino
                swiss taleggio. Goat mozzarella mascarpone cheesecake camembert de normandie rubber cheese melted cheese
                stilton. Emmental cow queso airedale monterey jack chalk and cheese hard cheese mascarpone. Airedale
                lancashire bocconcini.</p>
            <h3>cheese level 3</h3>
            <p>Cheesy feet blue castello cream cheese. Everyone loves danish fontina melted cheese cheese on toast
                airedale who moved my cheese who moved my cheese monterey jack. Cut the cheese cheese strings cheese and
                biscuits cheese and biscuits fondue when the cheese comes out everybody's happy gouda croque monsieur.
                Caerphilly who moved my cheese goat emmental roquefort croque monsieur cut the cheese.</p>
            <h4>cheese level 4</h4>
            <ul>
                <li>Croque monsieur fromage halloumi</li>
                <li>Danish fontina taleggio roquefort fondue cheese and</li>
                <li>biscuits the big cheese roquefort dolcelatte</li>
                <li>Caerphilly dolcelatte feta port-salut</li>
            </ul>
            <h5>cheese level 5</h5>
            <p>Cream cheese pepper jack cheddar. Swiss bavarian bergkase cheesy feet caerphilly mascarpone cheesy grin
                everyone loves cheesecake. Cheese and wine mascarpone cheddar caerphilly cottage cheese blue castello
                fromage who moved my cheese. Cheese slices the big cheese who moved my cheese cheese on toast cottage
                cheese lancashire monterey jack bavarian bergkase. Cheesy grin.
            </p>
        </div>
    </div>
    <script type="module">
        import { TextEditor } from './main.js';
        import { EditorState } from "prosemirror-state";
        import { EditorView } from "prosemirror-view";
        import { Schema, DOMParser } from "prosemirror-model";

        // Replace the document with the new content
        let editor;
        let doc;
        let view;
        //let contentHTML = document.querySelector('#edit-me');
        let contentHTML = "<div>HERE</div>"
        let mySchema;

        document.body.onload = function () {
            editor = new TextEditor();
            doc = DOMParser.fromSchema(editor.schema).parse(contentHTML)
            view = editor.view;
        }

        window.addEventListener('message', function (event) {
            // Handle messages from the parent
            // Add your logic to handle different message types here
            if (event.data[0] === 'get') {
                window.parent.postMessage(['innerHTMLContent', document.getElementById('edit-me').innerHTML], '*');
            } else if (event.data[0] === 'set') {
                const state = editor.view.state;
                const editorText = state.doc.content;
                console.log(doc.content);
                editor.view.dispatch(state.tr.insertText("", 2, 8));
                editor.view.dispatch(state.tr.insertText(event.data[1], 8));
            }
        });
    </script>
</body>

</html>